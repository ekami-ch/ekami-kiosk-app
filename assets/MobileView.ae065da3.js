import{G as E,S as F,_ as M}from"./ekami128x128.0bb11458.js";import{$ as m,_ as S,Q as T}from"./QrCode.3fd2c41d.js";import{d as B,i as h,r as v,o as n,c as r,a as o,n as y,b as w,F as p,e as _,f as $,t as k,g as f,h as L,j as b,k as C}from"./index.2893e218.js";const P=B({name:"FormNavigation",data(){return{recap:[],eventBus:h("eventBus")}},props:{formId:String,formClass:String,groupFields:Object,colors:Object,endMessage:String,thanksMessage:String,datepickerOptions:Object},computed:{cssProps(){var e,t,s,a;return{"--primary-color":(e=this.colors)==null?void 0:e.primary,"--secondary-color":(t=this.colors)==null?void 0:t.secondary,"--tertiary-color":(s=this.colors)==null?void 0:s.tertiary,"--quaternary-color":(a=this.colors)==null?void 0:a.quaternary}}},components:{GeneratorInputGroup:E},methods:{checkItem:function(){var t=m("#carouselForm");m(".carousel-inner .carousel-item:first").hasClass("active")?(t.children(".carousel-control-prev").hide(),t.children(".carousel-control-next").show()):m(".carousel-inner .carousel-item:last").hasClass("active")?(t.children(".carousel-control-next").hide(),t.children(".carousel-control-prev").show()):(t.children(".carousel-control-next").show(),t.children(".carousel-control-prev").show())},writeToRecap:function(){this.recap=[],document.querySelectorAll(".carousel-inner label").forEach(t=>{let s=document.querySelector("#"+t.htmlFor),a=s.value==""?t.innerText+" ?":s.value;this.recap.push(a)}),this.eventBus.emit("updateRecap",this.recap)},returnToBeggining:function(){var t;(t=document.getElementById("indicator0"))==null||t.click()}},mounted(){var e;this.eventBus=h("eventBus"),this.eventBus.on("returnToBeginning",this.returnToBeggining),document.querySelectorAll("input, select").forEach(t=>{["change","focus"].forEach(s=>{t.addEventListener(s,()=>{this.writeToRecap()})})}),this.checkItem(),(e=document.querySelector("#carouselForm"))==null||e.addEventListener("slid.bs.carousel",this.checkItem),m(".datepicker").datepicker(this.datepickerOptions)}}),A={class:"row"},I={class:"col-sm h-100",id:"form-div"},O=["id"],j={id:"carouselForm",class:"carousel carousel-dark slide","data-bs-interval":"false","data-bs-wrap":"false"},N={class:"carousel-indicators mt-4"},G=["id","data-bs-slide-to","aria-label"],Q=["id","data-bs-slide-to","aria-label"],V=["id","data-bs-slide-to","aria-label"],R={class:"carousel-inner"},x=["id"],z={id:"carousel-end",class:"carousel-item"},D={class:"container"},H={key:0,class:"fs-2 m-4 text-center"},U={key:1,class:"fs-2 m-4 text-center"},Y={class:"row d-flex justify-content-center"},J=o("button",{type:"button",class:"col-3 print-button m-2 fw-bold btn btn-kiosk ml-auto gx-1 btn-lg btn-success"},[o("span",{class:"fs-3"},[o("i",{class:"bi bi-person-check-fill"}),f(" Termin\xE9")])],-1),W=o("span",{class:"fs-3"},[o("i",{class:"fs-1bi bi-person-plus-fill"}),f(" Autre personne")],-1),X=[W],Z={key:0,class:"fs-3 m-4 text-center"},K={key:1,class:"fs-3 m-4 text-center"},ee=f(' Pour imprimer votre ticket, cliquez sur "Termin\xE9". '),te=o("br",null,null,-1),oe=f(` Pour d\xE9marrer la saisie d'une autre personne de votre famille (adresse identique), cliquez sur "Autre Personne". `),se=[ee,te,oe],ne=L('<button class="carousel-control-prev" type="button" data-bs-target="#carouselForm" data-bs-slide="prev"><span class="text-dark" aria-hidden="true">\u279C</span></button><button class="carousel-control-next" type="button" data-bs-target="#carouselForm" data-bs-slide="next"><span class="text-dark" aria-hidden="true">\u279C</span></button><button type="button" class="fs-3 m-4 cancel-button fw-bold btn btn-kiosk btn-danger"><i class="bi bi-trash-fill"></i></button>',3);function re(e,t,s,a,i,q){var d,u;const g=v("GeneratorInputGroup");return n(),r("div",A,[o("div",I,[o("form",{id:e.formId,class:y(e.formClass),style:w(e.cssProps)},[o("div",j,[o("div",N,[(n(!0),r(p,null,_(e.groupFields,(l,c)=>(n(),r(p,{key:c},[c==0?(n(),r("button",{key:0,id:"indicator"+c,type:"button","data-bs-target":"#carouselForm","data-bs-slide-to":c,"aria-current":"true",class:"active","aria-label":"Part"+c},null,8,G)):(n(),r("button",{key:1,id:"indicator"+c,type:"button","data-bs-target":"#carouselForm","data-bs-slide-to":c,"aria-current":"true","aria-label":"Part"+c},null,8,Q))],64))),128)),o("button",{id:"indicator"+Object.keys(e.groupFields).length,type:"button","data-bs-target":"#carouselForm","data-bs-slide-to":Object.keys(e.groupFields).length,"aria-current":"true","aria-label":"Part"+Object.keys(e.groupFields).length},null,8,V)]),o("div",R,[(n(!0),r(p,null,_(e.groupFields,(l,c)=>(n(),r("div",{key:c,id:l.id,class:y(l.class)},[$(g,{inputGroups:l.fields},null,8,["inputGroups"])],10,x))),128)),o("div",z,[o("div",D,[e.thanksMessage?(n(),r("p",H,k(e.thanksMessage),1)):(n(),r("p",U,"Merci !")),o("div",Y,[J,o("button",{type:"button",class:"col-3 print-add-button m-2 fw-bold btn btn-kiosk ml-auto gx-1 btn-lg",style:w({color:(d=e.colors)==null?void 0:d.secondary,backgroundColor:(u=e.colors)==null?void 0:u.primary}),onClick:t[0]||(t[0]=l=>e.returnToBeggining())},X,4),e.endMessage?(n(),r("p",Z,k(e.endMessage),1)):(n(),r("p",K,se))])])])]),ne])],14,O)])])}var ie=S(P,[["render",re]]);const ae=B({components:{FormNavigationMobile:ie,QrCode:T},data(){return{eventBus:h("eventBus"),config:{},recap:[],isLoaded:!1}},methods:{downloadCanvas:function(){console.log("download");let t=document.querySelector("#lastname").value+" "+document.querySelector("#firstname").value+" "+document.querySelector("#birthdate").value,s=document.querySelector("#lastname").value+" "+document.querySelector("#firstname").value;this.eventBus.emit("generateAndDownloadQrCode",[t,s])},addAnotherPerson:function(){this.eventBus.emit("updateQrCode"),setTimeout(function(){window.print(),document.querySelectorAll("input").forEach(t=>{t.hasAttribute("resettable")&&(t.value="")})},1e3)},redirectToPlatform:function(t){t.toLocaleLowerCase()=="mobile"?this.$router.push({name:"Mobile"}):t.toLocaleLowerCase()=="kiosk"&&this.$router.push({name:"Kiosk"})},printTicket:function(){this.eventBus.emit("updateQrCode"),setTimeout(function(){window.print(),window.location.reload()},1e3)},fetchConfigFile:function(t){fetch(t).then(s=>s.json()).then(s=>{this.config=s}).catch(s=>{var i;this.isLoaded=!0;let a=document.createElement("div");a.id="error_config",a.innerHTML="Invalid or Config File not found. Please check configuration file.",(i=document.querySelector("body"))==null||i.appendChild(a)})}},created(){this.fetchConfigFile("/ekami-kiosk-app//config.json")},mounted(){this.eventBus=h("eventBus")},updated(){var e=this;if(!e.isLoaded){e.eventBus.on("updateRecap",function(i){e.recap=i});let s=new URLSearchParams(document.location.search.substring(1)),a=s.has("platform")?s.get("platform"):"mobile";this.redirectToPlatform(a),document.querySelectorAll(".print-button").forEach(function(i){i.addEventListener("click",function(){e.printTicket()})}),document.querySelectorAll(".print-add-button").forEach(function(i){i.addEventListener("click",function(){e.addAnotherPerson(),e.eventBus.emit("returnToBeginning")})}),document.querySelectorAll(".cancel-button").forEach(function(i){i.addEventListener("click",function(){window.location.reload()})});var t=document.querySelector(e.config.form.id);t==null||t.addEventListener("change",()=>{e.eventBus.emit("updateQrCode","test")}),t==null||t.addEventListener("keyup",()=>{e.eventBus.emit("updateQrCode","test")}),document.querySelectorAll(".slim-select").forEach(i=>{new F({select:"#"+i.id,showSearch:!1})}),e.isLoaded=!0}}}),ce={class:"container-fluid vh-100",id:"main_container"},le={class:"nav justify-content-center"},de=["src"],ue={class:"bg-light align-items-center position-relative text-center",id:"utility_container"},me={class:"w-100 p-2",id:"recap_div"},pe=o("h4",{class:"fw-bold"},"Your information",-1),he=o("div",{class:"w-100 text-muted align-items-center position-fixed text-center",id:"copyright"},[o("img",{height:"32",width:"32",src:M,id:"copyright_logo"}),o("a",null," EKAMI SA (Gen\xE8ve)")],-1);function fe(e,t,s,a,i,q){const g=v("FormNavigationMobile"),d=v("QrCode");return n(),r("main",null,[o("div",ce,[o("div",le,[e.config.companyLogo!=""?(n(),r("img",{key:0,class:"img-fluid pt-5 mt-5",id:"company_logo",src:e.config.companyLogo},null,8,de)):b("",!0)]),o("div",ue,[o("div",me,[pe,(n(!0),r(p,null,_(e.recap,(u,l)=>(n(),r("p",{key:l},k(u),1))),128))])]),e.config.form?(n(),C(g,{key:0,formId:e.config.form.id,formClass:e.config.form.class,groupFields:e.config.form.fieldGroups,colors:e.config.colors,thanksMessage:e.config.form.thanksMessage,endMessage:e.config.form.endMessage,datepickerOptions:e.config.datepickerOptions},null,8,["formId","formClass","groupFields","colors","thanksMessage","endMessage","datepickerOptions"])):b("",!0),e.config.qrOptions?(n(),C(d,{key:1,qrOptions:e.config.qrOptions,context:e.config.context,qrCodeId:"qrcode"},null,8,["qrOptions","context"])):b("",!0),he])])}var _e=S(ae,[["render",fe]]);export{_e as default};
