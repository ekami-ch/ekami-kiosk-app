import{_ as i}from"./QrCode.6aaa7f57.js";import{d,i as c,o as r,c as f}from"./index.a479a3c5.js";const u=d({name:"DownloadableCanvasTicket",data(){return{config:{},fieldGroups:[],y:340,downloadName:"demo.png"}},methods:{downloadCanvas(){this.updateCanvas();const a=this.$refs.downloadableCanvas,e=document.createElement("a");e.download=this.downloadName,e.href=a.toDataURL("image/png"),e.click()},fetchConfigFile:function(e){fetch(e).then(o=>o.json()).then(o=>{this.config=o,this.fieldGroups=o.form.fieldGroups}).catch(o=>{console.log(o)})},updateCanvas(){const a=this.$refs.downloadableCanvas;a.width=a.width,this.y=340;const e=a.getContext("2d");if(e){e.fillStyle="white",e.fillRect(0,0,300,600),e.font="18px Arial",e.fillStyle="black",e.fillText("DEMO",130,40);const o=document.querySelector("#qrcode canvas");console.log(o),e.drawImage(o,20,50,260,260),this.fieldGroups.forEach(s=>{s.fields.forEach(n=>{n.name==="firstname"&&(this.downloadName=`${document.querySelector("#firstname").value}`),n.name==="lastname"&&(this.downloadName+=` ${document.querySelector("#lastname").value}.png`);const t=document.querySelector(`#${n.id}`);console.log(t.value),e.fillText(`${n.name}: ${t.value}`,20,this.y),this.y+=40})})}}},mounted(){this.fetchConfigFile("config.json");const a=c("eventBus");a.on("updateDownloadableCanvas",()=>{this.updateCanvas()}),a.on("downloadQrCodeCanvas",()=>{this.downloadCanvas()})}});function h(a,e,o,s,n,t){return r(),f("canvas",{ref:"downloadableCanvas",onClick:e[0]||(e[0]=(...l)=>a.updateCanvas&&a.updateCanvas(...l)),style:{position:"fixed",top:"0",left:"0",visibility:"hidden"},width:"300",height:"600"},null,512)}var v=i(u,[["render",h]]);export{v as D};
