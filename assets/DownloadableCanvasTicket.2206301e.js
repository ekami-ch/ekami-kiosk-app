import{_ as i}from"./ekami128x128.9e22503c.js";import{d,i as c,o as r,c as f}from"./index.8242e31a.js";const m=d({name:"DownloadableCanvasTicket",data(){return{config:{},fieldGroups:[],y:395,downloadName:"demo.png"}},methods:{downloadCanvas(){this.updateCanvas();const a=this.$refs.downloadableCanvas,e=document.createElement("a");e.download=this.downloadName,e.href=a.toDataURL("image/png"),e.click()},fetchConfigFile:function(e){fetch(e).then(o=>o.json()).then(o=>{this.config=o,this.fieldGroups=o.form.fieldGroups}).catch(o=>{console.log(o)})},updateCanvas(){const a=this.$refs.downloadableCanvas;a.width=a.width,this.y=395;const e=a.getContext("2d");if(e){e.fillStyle="white",e.fillRect(0,0,300,620),e.drawImage(document.querySelector("#company_logo"),60,20,170,50),e.font="18px Helvetica",e.fillStyle="black",e.fillText("DATA COLLECTION DEMO",36,100);const o=document.querySelector("#qrcode canvas");console.log(o),e.drawImage(o,20,110,260,260),this.fieldGroups.forEach(s=>{s.fields.forEach(n=>{n.name==="firstname"&&(this.downloadName=`${document.querySelector("#firstname").value}`),n.name==="lastname"&&(this.downloadName+=` ${document.querySelector("#lastname").value}.png`);const t=document.querySelector(`#${n.id}`);console.log(t.value),e.fillText(`${n.name}: ${t.value}`,27,this.y),this.y+=40})})}}},mounted(){this.fetchConfigFile("config.json");const a=c("eventBus");a.on("updateDownloadableCanvas",()=>{console.log("Updating downloadable canvas"),this.updateCanvas()}),a.on("downloadQrCodeCanvas",()=>{this.downloadCanvas()})}});function u(a,e,o,s,n,t){return r(),f("canvas",{id:"downloadableCanvas",ref:"downloadableCanvas",onClick:e[0]||(e[0]=(...l)=>a.updateCanvas&&a.updateCanvas(...l)),style:{position:"fixed",top:"0",left:"0",visibility:"hidden"},width:"300",height:"620"},null,512)}var p=i(m,[["render",u]]);export{p as D};
